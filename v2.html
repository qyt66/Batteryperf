<!DOCTYPE html>
<html>
<head>
  <title>Battery Drain Test - V2 Turbo Mode</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
      color: white;
      font-family: sans-serif;
      text-align: center;
    }
    canvas, #webgl {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
    }
    h1, p {
      margin: 1rem 0 0;
      z-index: 10;
      position: relative;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { opacity: 0.8; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.02); }
      100% { opacity: 0.8; transform: scale(1); }
    }
  </style>
</head>
<body>
  <h1>‚ö†Ô∏è Battery Load Test V2 Running...</h1>
  <p>üëÜ Tap anywhere to keep screen awake</p>
  <canvas id="canvas"></canvas>
  <canvas id="webgl"></canvas>

  <script>
    // === Resize ===
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const webglCanvas = document.getElementById('webgl');

    function resizeAll() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      webglCanvas.width = window.innerWidth;
      webglCanvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeAll);
    resizeAll();

    // === Animated Canvas (GPU stress, dynamic squares) ===
    function animateCanvas(ctx, width, height) {
      const squareSize = 30;
      function drawFrame() {
        ctx.clearRect(0, 0, width, height);
        for (let y = 0; y < height; y += squareSize) {
          for (let x = 0; x < width; x += squareSize) {
            ctx.fillStyle = `hsla(${(x + y + Date.now() / 10) % 360}, 100%, 50%, 0.5)`;
            ctx.fillRect(
              x + Math.sin(Date.now() / 300 + x) * 5,
              y + Math.cos(Date.now() / 300 + y) * 5,
              squareSize - 2,
              squareSize - 2
            );
          }
        }
        requestAnimationFrame(drawFrame);
      }
      drawFrame();
    }
    animateCanvas(ctx, canvas.width, canvas.height);

    // === WebGL Shader ===
    const gl = webglCanvas.getContext('webgl');
    const vertexShaderSource = `attribute vec4 position; void main() { gl_Position = position; }`;
    const fragmentShaderSource = `precision mediump float;
      void main() {
        gl_FragColor = vec4(mod(gl_FragCoord.x + gl_FragCoord.y + mod(gl_FragCoord.x*gl_FragCoord.y, 255.0), 255.0) / 255.0, 0.0, 1.0, 1.0);
      }`;
    function createShader(gl, type, source) {
      const shader = gl.createShader(type);
      gl.shaderSource(shader, source);
      gl.compileShader(shader);
      return shader;
    }
    const vs = createShader(gl, gl.VERTEX_SHADER, vertexShaderSource);
    const fs = createShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSource);
    const program = gl.createProgram();
    gl.attachShader(program, vs);
    gl.attachShader(program, fs);
    gl.linkProgram(program);
    gl.useProgram(program);
    const positionBuffer = gl.createBuffer();
    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, 1]), gl.STATIC_DRAW);
    const posLoc = gl.getAttribLocation(program, 'position');
    gl.enableVertexAttribArray(posLoc);
    gl.vertexAttribPointer(posLoc, 2, gl.FLOAT, false, 0, 0);
    function drawWebGL() {
      gl.drawArrays(gl.TRIANGLES, 0, 6);
      requestAnimationFrame(drawWebGL);
    }
    drawWebGL();

    // === CPU Burn ===
    function cpuBurner() {
      const start = performance.now();
      while (performance.now() - start < 100) {
        Math.sqrt(Math.random() * 1e6);
      }
      setTimeout(cpuBurner, 0);
    }
    cpuBurner();

    // === Web Worker CPU ===
    if (window.Worker) {
      const blob = new Blob([`onmessage=function(){while(1){Math.sqrt(Math.random()*1e6);}}`], { type: 'application/javascript' });
      const worker = new Worker(URL.createObjectURL(blob));
      worker.postMessage('go');
    }

    // === GPS + Sensors ===
    if (navigator.geolocation) {
      setInterval(() => {
        navigator.geolocation.getCurrentPosition(
          pos => console.log(`GPS: ${pos.coords.latitude}, ${pos.coords.longitude}`),
          err => console.warn("GPS error:", err)
        );
      }, 1000);
    }

    window.addEventListener('deviceorientation', event => {
      console.log(`Orientation: alpha=${event.alpha}, beta=${event.beta}, gamma=${event.gamma}`);
    });
    window.addEventListener('devicemotion', event => {
      console.log('Motion:', event.acceleration);
    });

    if (navigator.getBattery) {
      navigator.getBattery().then(battery => {
        setInterval(() => {
          console.log(`Battery: ${battery.level * 100}% (charging: ${battery.charging})`);
        }, 3000);
      });
    }

    // === Wake Lock Video ===
    const video = document.createElement('video');
    video.style.position = 'absolute';
    video.style.width = '1px';
    video.style.height = '1px';
    video.style.opacity = '0';
    video.muted = true;
    video.loop = true;
    video.playsInline = true;
    video.src = "data:video/mp4;base64,AAAAHGZ0eXBtcDQyAAAAAG1wNDFtcDQyaXNvbTEybXA0MnYxAAAAAW1vb3YAAABsbXZoZAAAAAB8JgABfCYAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAABxpb2RzAAAAAAEAAAAMAAAD6wABAAAAAAO6AAAC3///8AAAAAAGnZHRyYWsAAABcdGtoZAAAAAB8JgABfCYAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAABAAAAAAACc3RibAAAACBzdHNkAAAAAAAAAAEAAQABAAAABAAAAAABAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAABAAAADGF2YzEAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA";
    document.body.appendChild(video);

    const tryPlay = () => {
      video.play().then(() => console.log("Wake Lock video playing")).catch(err => console.warn("Wake Lock video blocked:", err));
    };
    document.addEventListener('click', tryPlay);
    document.addEventListener('touchstart', tryPlay);
  </script>
</body>
</html>
